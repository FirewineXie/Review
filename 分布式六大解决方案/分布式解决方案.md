# 分布式六大解决方案



## 分布式ID



### 传统方案

1. 时间戳
2. UUID



### 特点

1. 全局唯一
2. 高并发
3. 高可用

### 方案



####  UUID

缺点

1. 空间占用较多
2. 不能生成递增有序的数字，索引效率下降

#### 数据库主键自增

缺点：

1. 并发性能不高，受限于数据库性能
2. 分库分表，需改造，较复杂
3. 自增： 数据量泄露

#### Redis 自增

缺点：

1. 数据丢失
2. 自增： 数据量泄露

#### snawflake（雪花算法）

缺点：

时钟回拨



### 方案总结

####  号段模式

> 与数据库自增 不同的，
>
> 主键自增
>
> 1,2,3,4
>
> 号段模式
>
> 100,200,300
>
> 1..100, 101...200
>
> `每次获取一个数字,等于获取100个主键`
>
> 性能提高，并且还是自增

#### 雪花算法

> 舍弃负数

二进制数据长度： 41 bit + 10 bit  + 12 bit

- 41 -   时间戳为
- 10  -  工作进程位：：地域 + 服务器
- 12  -  序列号为 ：： 一般为自增



### 开源组件

1. 百度 —— uid-generator
   1. 雪花算法
   2. 无人维护
2. 滴滴 —— Tinyid
   1. 只支持数据库号段
   2. 高可用
3. 美图 —— leaf （上面两种都只支持）
   1. 号段模式 + 雪花模式